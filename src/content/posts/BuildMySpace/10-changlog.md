---
title: è‡ªåŠ¨ç”Ÿæˆçš„ChangeLogé¡µé¢
date: 2022-12-03
tags:
    - åšå®¢æ”¹é€ 
    - butterfly
category: åšå®¢
star: 1
description: æœ¬æ¥æƒ³è¯•è¯•èƒ½ä¸èƒ½è¯»å–git commitçš„ä¿¡æ¯æ¥ç”Ÿæˆåšå®¢çš„æ›´æ–°æ—¥å¿—é¡µé¢ï¼Œç„¶åæ‰¾åˆ°standard-versionè‡ªåŠ¨ç”ŸæˆCHANGELOGæ—¥å¿—ï¼Œè™½ç„¶mdæ ¼å¼åªèƒ½ä½œä¸ºæ–‡æ¡£æ ¼å¼æ¥æ˜¾ç¤ºï¼Œä½†ä¹ŸåŸºæœ¬æ»¡è¶³éœ€æ±‚äº†ï¼ˆå…¶å®æˆ‘æ›´æƒ³æ‰¾ä¸€ä¸ªè§£æçš„åº“ï¼Œç„¶åè‡ªå®šä¹‰é¡µé¢æ ·å¼ï¼‰
cover: https://img.dorakika.cn/md/20221203.png
slug: '20221203'
---
æœ¬æ¥æƒ³è¯•è¯•èƒ½ä¸èƒ½è¯»å–git commitçš„ä¿¡æ¯æ¥ç”Ÿæˆåšå®¢çš„æ›´æ–°æ—¥å¿—é¡µé¢ï¼Œç„¶åæ‰¾åˆ°standard-versionè‡ªåŠ¨ç”ŸæˆCHANGELOGæ—¥å¿—ï¼Œè™½ç„¶mdæ ¼å¼åªèƒ½ä½œä¸ºæ–‡æ¡£æ ¼å¼æ¥æ˜¾ç¤ºï¼Œä½†ä¹ŸåŸºæœ¬æ»¡è¶³éœ€æ±‚äº†ï¼ˆå…¶å®æˆ‘æ›´æƒ³æ‰¾ä¸€ä¸ªè§£æçš„åº“ï¼Œç„¶åè‡ªå®šä¹‰é¡µé¢æ ·å¼ï¼‰

{% link æœ¬åšå®¢æ›´æ–°æ—¥å¿—, DORAKIKA, https://blog.dorakika.cn/changelog/ %}

## gitæäº¤è§„èŒƒ
æ—¢ç„¶è¦è‡ªåŠ¨ç”Ÿæˆï¼Œé‚£æºæ•°æ®è‡ªç„¶æ˜¯è¦â€œæ ¼å¼åŒ–çš„â€ï¼ˆäº‹å®ä¸Šåœ¨å¼€å‘ä¸­ï¼ŒåŸºæœ¬éƒ½ä¼šæœ‰ä¸€å¥—æäº¤è§„èŒƒï¼Œå³ç»Ÿä¸€äº†æ ¼å¼ï¼Œä¹Ÿä½¿æ¯æ¬¡æäº¤çš„ä¿¡æ¯æ›´åŠ æ¸…æ™°ï¼‰

### commit messageæ ¼å¼
ä¸€ä¸ªæ ‡å‡†çš„commit messageæ ¼å¼å¦‚ä¸‹ï¼š
- ä¿®æ”¹ç±»å‹æœ‰ï¼š
  - feat:æäº¤æ–°åŠŸèƒ½
  - fix: ä¿®å¤äº†bug
  - docs: ä¿®æ”¹æ–‡æ¡£
  - style: ä¿®æ”¹ä»£ç æ ¼å¼ï¼ˆå¹¶æœªä¿®æ”¹é€»è¾‘ï¼Œå¦‚æ ¼å¼åŒ–ï¼Œä¿®æ”¹ç©ºæ ¼ï¼Œåˆ†å·ç­‰ï¼‰
  - refactor: ä»£ç é‡æ„ï¼ˆæ²¡æœ‰ä¿®å¤bugæˆ–æ·»åŠ æ–°åŠŸèƒ½ï¼‰
  - pref: æ€§èƒ½ä¼˜åŒ–
  - test: æ·»åŠ æˆ–ä¿®æ”¹ä»£ç æµ‹è¯•
  - chore: å¯¹æ„å»ºæµç¨‹æˆ–è¾…åŠ©å·¥å…·å’Œä¾èµ–åº“çš„æ›´æ”¹
  - ci: CIé…ç½®æ–‡ä»¶æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
  - ...
- å½±å“èŒƒå›´ï¼ˆå¯é€‰ï¼‰ï¼šè¯´æ˜æœ¬æ¬¡commitçš„èŒƒå›´
- æ ‡é¢˜ï¼ˆå¿…é€‰ï¼‰ï¼šæœ¬æ¬¡commitçš„ç®€çŸ­æè¿°
- æ­£æ–‡ï¼ˆå¯é€‰ï¼‰ï¼šæœ¬æ¬¡commitçš„è¯¦ç»†æè¿°
- footerï¼šä»»ä½•ç ´åæ€§å˜æ›´

```plaintext
type(å½±å“èŒƒå›´): subject
<--ç©ºè¡Œ-->
[body]
<--ç©ºè¡Œ-->
[footer]
```

ä¸€èˆ¬æ¥è®²ï¼Œåªéœ€è¦å¡«å†™type + subjectå³å¯ï¼Œå¦‚`feat: æ·»åŠ æœ‹å‹åœˆåŠŸèƒ½`ï¼›å…³äºgit commitçš„æ ¼å¼åŒ–ï¼Œç¼–è¾‘å™¨åŸºæœ¬éƒ½æœ‰ç›¸å…³æ’ä»¶è¾…åŠ©æ“ä½œï¼ˆå¦‚vscodeçš„commitizenï¼‰

## ä½¿ç”¨standard-versionç”ŸæˆCHANGELOG.md

{% link standard-version, github, https://github.com/conventional-changelog/standard-version %}

### å®‰è£…standard-version

```shell
npm i standard-version --save-dev
```

### é…ç½®æ–‡ä»¶`.versionrc.js`
- åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º`.versionrc.js`æ–‡ä»¶ï¼Œå‚è€ƒé…ç½®å¦‚ä¸‹
- æ ¹æ®ä¸‹æ–¹å®šä¹‰çš„typeä¼šè‡ªåŠ¨ç”ŸæˆCHANGELOG.md

```js
module.exports = {
    "types": [
        { "type": "feat", "section": "âœ¨ Features | æ–°åŠŸèƒ½" },
        { "type": "fix", "section": "ğŸ› Bug Fixes | Bug ä¿®å¤" },
        { "type": "docs", "section": "âœï¸ blog | åšå®¢å†…å®¹" },
        { "type": "style", "section": "ğŸ’„ Styles | æ ·å¼" },
        { "type": "perf", "section": "âš¡ Performance Improvements | æ€§èƒ½ä¼˜åŒ–" },
        { "type": "init", "section": "ğŸ‰ Init | åˆå§‹åŒ–" },
        { "type": "refactor", "section": "â™»ï¸ Code Refactoring | ä»£ç é‡æ„", "hidden": true },
        { "type": "test", "section": "âœ… Tests | æµ‹è¯•", "hidden": true },
        { "type": "revert", "section": "âª Revert | å›é€€", "hidden": true },
        { "type": "build", "section": "ğŸ“¦â€ Build System | æ‰“åŒ…æ„å»º", "hidden": true },
        { "type": "chore", "section": "ğŸš€ Chore | æ„å»º/å·¥ç¨‹ä¾èµ–/å·¥å…·", "hidden": true },
        { "type": "ci", "section": "ğŸ‘· Continuous Integration | CI é…ç½®", "hidden": true }
    ],
}
```

- å®Œæˆä¹‹åå¯é…ç½®package.jsonå‘½ä»¤


```json
{
  "scripts": {
    "release": "standard-version",
  },
}
```

- ä¹‹ååœ¨ç»ˆç«¯è¿è¡Œ`npm run release` å³å¯releaseä¸€ä¸ªå°ç‰ˆæœ¬ï¼ˆstandard-version --release-as minor  |  standard-version --release-as major åˆ†åˆ«å¯ä½¿x.y.zä¸­çš„yå’ŒzåŠ 1ï¼‰
- ç”Ÿæˆçš„CHANGELOGå‚è€ƒå¦‚ä¸‹

```md
ä¸¤æ¬¡æäº¤

feat: æ·»åŠ æœ‹å‹åœˆåŠŸèƒ½
fix: å›¾ç‰‡é“¾æ¥å¤±æ•ˆä¿®å¤

ä¹‹å npm run releaseï¼Œå°±ä¼šæ›´æ–°CHANGELOG.mdæ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆä¸€æ¬¡releaseæäº¤

### [x.y.z](https://xxx) (yyyy-mm-dd)

### âœ¨ Features | æ–°åŠŸèƒ½

* æ·»åŠ æœ‹å‹åœˆåŠŸèƒ½ ([66d16ad](https://xxx))

### ğŸ› Bug Fixes | Bug ä¿®å¤

* å›¾ç‰‡é“¾æ¥å¤±æ•ˆä¿®å¤ ([66d16ad](https://xxx))


```


## ä»CHANGELOG.mdç”Ÿæˆé¡µé¢
- ç°åœ¨ï¼Œå¯æ‰‹åŠ¨è¿è¡Œstandard-versionå‘½ä»¤æ¥å®ç°ç‰ˆæœ¬å‘å¸ƒä¸CHANGELOGè‡ªåŠ¨ç”Ÿæˆï¼Œä½†æ˜¯æˆ‘çš„éœ€æ±‚æ˜¯ç”Ÿæˆä¸€ä¸ªé¡µé¢
- ç°åœ¨å°±éœ€è¦å°†CHANGELOG.mdä¸­çš„å†…å®¹copyåˆ°é¡µé¢æ–‡æ¡£ä¸­

### ç¼–å†™é¡µé¢è‡ªå®šä¹‰å†…å®¹
- changlogé¡µé¢ä¸­é™¤äº†è‡ªåŠ¨ç”Ÿæˆçš„æ›´æ–°æ—¥å¿—ä¹‹å¤–ï¼Œè¿˜éœ€è¦ä¸€äº›é¡µé¢å…ƒä¿¡æ¯ï¼ˆæ ‡é¢˜ï¼Œä¾§æ é…ç½®ç­‰ï¼‰
- æ‰€ä»¥éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ–°å»ºä¸€ä¸ª`_index.md`æ–‡ä»¶æ¥å­˜å‚¨è¿™äº›å†…å®¹
- åœ¨ä½ å­˜æ”¾é¡µé¢çš„åœ°æ–¹æ–°å»º`changelog`æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å®ƒçš„å†…éƒ¨æ–°å»º`_index.md`æ–‡ä»¶ï¼Œå¦‚ä¸‹

```md
---

title: æ›´æ–°æ—¥å¿—
aside: false
permalink: /changelog/

---

> æœ¬æ›´æ–°æ—¥å¿—ä¸ºè‡ªåŠ¨ç”Ÿæˆï¼Œå¯èƒ½ä¼šæœ‰bug

```

### copyæ›´æ–°æ—¥å¿—
- éœ€è¦åœ¨ç”ŸæˆCHANGELOGä¹‹åå°±ç«‹å³æ›´æ–°æˆ‘ä»¬çš„é¡µé¢æ–‡ä»¶
- è¿™å°±å¯ä»¥ä»standard-versionçš„ç”Ÿå‘½å‘¨æœŸå…¥æ‰‹ï¼Œå®ƒå¯ä»¥åœ¨ ç”ŸæˆCHANGELOGä¹‹åçš„ æ‰§è¡Œè„šæœ¬
- åœ¨package.jsonä¸­å¢åŠ å¦‚ä¸‹å†…å®¹ï¼›åœ¨ç”Ÿæˆchangelogä¹‹åæ‰§è¡Œnodeè„šæœ¬ï¼ˆè¿™ä¸ªè„šæœ¬ä¹Ÿå¯ä»¥æ”¾åœ¨å…¶ä»–åœ°æ–¹ï¼Œä¸è¿‡æˆ‘ä¸ºäº†æ–¹ä¾¿å°±æ”¾åœ¨äº†æ ¹ç›®å½•

```json
{
    "standard-version": {
        "scripts": {
            "postchangelog": "node ./generate_changelog.js"
        }
    }
}
```

- generate_changelog.jså¦‚ä¸‹ï¼Œå…¶åŠŸèƒ½å°±æ˜¯è¯»å–`_index.md`å’Œ`CHANGELOG.md`çš„å†…å®¹å¹¶å°†ä»–ä»¬åˆå¹¶èµ·æ¥å†™åˆ°çœŸæ­£è¦è¢«æ¸²æŸ“çš„`index.md`ä¸­å»ï¼ˆæœ¬æ¥æƒ³ç›´æ¥ç”¨å‘½ä»¤è¡Œå®ç°çš„ï¼Œä½†æ˜¯å‘ç°ä¼šå‡ºç°ä¹±ç ï¼Œå°±è½¬è€Œä½¿ç”¨è„šæœ¬äº†ï¼‰

```js
const {exec} = require("child_process");
const fs = require('fs');

fs.readFile('./source/pages/changelog/_index.md', (err, meta) => {
    if(err)console.error(err);

    fs.readFile('./CHANGELOG.md', async (err, changelog)=>{
        if(err)console.error(err);
        
        await fs.writeFileSync(
            './source/pages/changelog/index.md',
            meta + '\n' + changelog,
            (err) => console.error(err)
        )
        gitCommit()
    })

})

function gitCommit(){
    exec('git add ./source/pages/changelog/index.md && git commit -m "chore(changelog): ç”Ÿæˆchangelogé¡µé¢"')
}
```

- é…ç½®å®Œæˆä¹‹åï¼Œè¿è¡Œ`npm run release`å°±ä¼šåœ¨releaseç”ŸæˆCHANGELOGçš„åŒæ—¶ï¼Œä¹Ÿç”Ÿæˆé¡µé¢æ–‡ä»¶ä¸­çš„changlog/index.md

### éƒ¨ç½²å‘½ä»¤
- æ·»åŠ `publish`å‘½ä»¤ï¼šå…ˆæ‰§è¡Œreleaseç‰ˆæœ¬å‘å¸ƒï¼Œç„¶åæ‰§è¡Œhexoçš„deployéƒ¨ç½²
- `deploy`ä¸ºå•çº¯éƒ¨ç½²ï¼Œä¸æ¶‰åŠç‰ˆæœ¬è¿­ä»£ï¼›publishä¼šè¿­ä»£ç‰ˆæœ¬ç„¶ådeploy
- minorï¼Œmajoråˆ†åˆ«æ§åˆ¶ä¸åŒç¨‹åº¦çš„ç‰ˆæœ¬å˜æ›´ï¼ˆx.y.zä¸­çš„yå’Œxï¼Œä¸åŠ å‚æ•°é»˜è®¤ä¸ºz)

```json
{
    "scripts":{
        "deploy": "hexo deploy -g",
        "publish": "standard-version --release && hexo deploy -g",
        "publish-minor": "standard-version --release-as minor && hexo deploy -g",
        "publish-major": "standard-version --release-as major && hexo deploy -g"
    }
}

```

## æ•´ä½“æµç¨‹
- ä»¥ä¸€å¤©ä¸ºä¾‹ï¼Œä»Šå¤©æ›´æ–°äº†åŠŸèƒ½Faï¼ŒFbï¼›ä¿®å¤äº†bugï¼šBcã€‚Bdï¼ŒBeï¼Œæ›´æ–°äº†æ–‡ç« Dfï¼Œæ·»åŠ äº†å‹é“¾Lgã€‚commitå¦‚ä¸‹

```
feat: æ–°å¢Fa
feat: æ–°å¢Fb
fix: è§£å†³äº†Bcé€ æˆçš„xx
fix: ä¿®å¤bd
fix: ä¿®å¤äº†Beçš„é—®é¢˜
docs(ğŸ“): æ–°å¢æ–‡ç« Df
docs(ğŸ…): å‹é“¾æ·»åŠ Lg
```

- å¿™ç¢Œäº†ä¸€å¤©ä¹‹åï¼Œæ‰§è¡Œå‘½ä»¤`npm run publish`å‘å¸ƒåšå®¢å†…å®¹
- ç”Ÿæˆæ–‡æ¡£å¦‚ä¸‹

```md
...meta...

### [1.2.3](https://github.com/xxx/x/x/x/v1.2.3) (2022-12-03)

### âœ¨ Features | æ–°åŠŸèƒ½

* æ–°å¢Fa ([66d16ad](https://xxx))
* æ–°å¢Fb ([66d16ad](https://xxx))

### ğŸ› Bug Fixes | Bug ä¿®å¤
* è§£å†³äº†Bcé€ æˆçš„xx ([66d16ad](https://xxx))
* ä¿®å¤bd ([66d16ad](https://xxx))
* ä¿®å¤äº†Beçš„é—®é¢˜ ([66d16ad](https://xxx))

### âœï¸ blog | åšå®¢å†…å®¹
* **ğŸ“**:æ–°å¢æ–‡ç« Df ([66d16ad](https://xxx))
* **ğŸ…**:å‹é“¾æ·»åŠ Lg ([66d16ad](https://xxx))

```